var csv=require("fast-csv"),ml=require("machine_learning"),request=require("request"),features=[],effectivness=[];function getRecommendations(e){var a=["PieChart","BarChart","LineChart","Scatterplot","Table"],r=new ml.DecisionTree({data:features,result:effectivness});r.build();var n={};for(i=0;i<e.length;i++){for(j=0;j<a.length;j++){"Numerical"!=e[i][1]&&"Nominal"!=e[i][1]&&"Ordinal"!=e[i][1]&&console.log("Parameter 2 is incorrect! Accepted data attributes [Ordinal,Nominal,Numerical]"),"Numerical"!=e[i][2]&&"Nominal"!=e[i][2]&&"Ordinal"!=e[i][2]&&console.log("Parameter 3 is incorrect! Accepted data attributes [Ordinal,Nominal,Numerical]"),"Numerical"==e[i][1]||"Numerical"==e[i][2]?"Numerical"!=e[i][2]&&(e[i][1]=e[i][2],e[i][2]="Numerical"):("Ordinal"==e[i][1]&&"Nominal"==e[i][2]&&(e[i][1]="Nominal",e[i][2]="Numerical"),"Ordinal"==e[i][1]&&"Ordinal"==e[i][2]&&(e[i][1]="Ordinal",e[i][2]="Numerical"),"Nominal"==e[i][1]&&"Nominal"==e[i][2]&&(e[i][1]="Nominal",e[i][2]="Numerical"),"Nominal"==e[i][1]&&"Ordinal"==e[i][2]&&(e[i][1]="Nominal",e[i][2]="Numerical"));var t=calculateRanking(r.classify([e[i][0],e[i][1],e[i][2],a[j]]));name=a[j],n[name]=t}return n=Object.keys(n).sort(function(e,i){return n[i]-n[e]})}}function calculateRanking(e){var i=0;for(key in e)"Very Good"==key&&(i+=3*e["Very Good"]),"Good"==key&&(i+=2*e.Good),"OK"==key&&(i+=1*e.OK),"Bad"==key&&(i+=-2*e.Bad),"Very Bad"==key&&(i+=-3*e["Very Bad"]);return i}module.exports={getChartPeformance:function(e,i){csv.fromStream(request("http://bahadorsaket.com/others/ranking.csv")).on("data",function(e){features.push([e[0],e[1],e[2],e[3]]),effectivness.push(e[4])}).on("end",function(){i(getRecommendations(e))})}};